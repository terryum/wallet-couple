# PRD: 소득 관리 기능

## 개요
기존 지출(expense) 관리에 더해 소득(income)을 추가로 관리하여 월별 수지(收支)를 파악할 수 있게 합니다.

## 개념
- **지출 (expense)**: 마이너스 금액 개념 - 카드 결제, 상품권 사용 등
- **소득 (income)**: 플러스 금액 개념 - 급여, 상여, 환급금 등

## 소득 카테고리

| 카테고리 | 설명 | 예시 |
|---------|------|------|
| 급여 | 월급, 정기 급여 | 회사 급여 |
| 상여 | 보너스, 인센티브 | 연말 상여금 |
| 정부/환급 | 정부 지원금, 세금 환급 | 연말정산 환급, 육아수당 |
| 강연/도서 | 부수입 (강연료, 인세 등) | 강연료, 원고료 |
| 금융소득 | 이자, 배당, 투자 수익 | 예금 이자, 주식 배당 |
| 기타소득 | 기타 수입 | 중고 판매, 경품 등 |

## 데이터 소스

### 현재 지원 예정
1. **우리은행 거래내역** - 급여, 이체 입금 등
2. **한국투자증권 거래내역** (미래) - 배당금, 이자 등 금융소득

### 데이터 구분 로직
- 우리은행 거래내역에서 입금(+)은 소득, 출금(-)은 지출로 자동 분류
- AI 분류기가 거래 내용을 보고 적절한 카테고리 자동 할당

## 데이터베이스 스키마 변경

### transactions 테이블 수정
```sql
-- 거래 유형 컬럼 추가
ALTER TABLE transactions
ADD COLUMN transaction_type TEXT NOT NULL DEFAULT 'expense'
CHECK (transaction_type IN ('expense', 'income'));

-- 인덱스 추가
CREATE INDEX idx_transactions_type ON transactions(transaction_type);
CREATE INDEX idx_transactions_date_type ON transactions(transaction_date, transaction_type);
```

### 필드 설명
| 컬럼 | 타입 | 설명 |
|------|------|------|
| transaction_type | TEXT | 'expense' (지출) 또는 'income' (소득) |

## UI/UX 변경 사항

### 1. 내역 화면 (/)
- 소득/지출 필터 토글 추가
- 소득 항목은 녹색(+), 지출 항목은 빨간색(-) 으로 구분
- 소득 항목 추가 시 카테고리 선택지가 소득 카테고리로 변경

### 2. 분석 화면 (/dashboard)
- 월별 수지 요약 카드 추가 (소득 - 지출 = 순수익)
- 소득 파이차트 (카테고리별 비율)
- 소득 vs 지출 비교 막대그래프

### 3. 파일 업로드
- 우리은행 데이터로더 추가
- 입금/출금 자동 구분

## 카테고리 상수 정의

### 지출 카테고리 (기존)
**AI 자동 분류 (Set A):**
- 식료품, 외식/커피, 쇼핑, 관리비, 통신/교통, 육아, 미용/기타, 기존할부, 이자, 양육비

**사용자 수동 (Set B):**
- 여행, 부모님, 친구/동료, 경조사/선물, 가전/가구, 기타

### 소득 카테고리 (신규)
- 급여, 상여, 정부/환급, 강연/도서, 금융소득, 기타소득

## 구현 순서

### Phase 1: 데이터베이스 & 타입
1. [x] PRD 문서 작성
2. [ ] Supabase 마이그레이션 (transaction_type 컬럼 추가)
3. [ ] TypeScript 타입 정의 수정
4. [ ] 소득 카테고리 상수 추가

### Phase 2: 데이터로더
1. [ ] 우리은행 거래내역 파서 개발
2. [ ] 입금/출금 자동 구분 로직
3. [ ] AI 분류기 소득 카테고리 지원

### Phase 3: UI
1. [ ] 내역 화면 소득/지출 구분 표시
2. [ ] 수지 요약 카드
3. [ ] 소득 분석 차트

### Phase 4: 확장
1. [ ] 한국투자증권 데이터로더 (금융소득)
