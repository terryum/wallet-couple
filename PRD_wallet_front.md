# Product Requirement Document (PRD): Wallet Frontend

## 1. 개요 (Overview)
* **문서명:** PRD_wallet_front.md
* **목적:** 가계부 데이터의 조회, 수정, 시각화 분석을 위한 모바일 웹 프론트엔드 상세 명세.
* **디자인 컨셉:** Apple Human Interface Guidelines를 지향하는 **Clean, Minimal, Fluid** 디자인.
* **주요 화면:** 1. **내역 (Transactions):** 데이터 업로드 및 테이블 관리
    2. **분석 (Dashboard):** 월별/추세 분석 그래프

## 2. 디자인 가이드라인 (Design System)
* **Look & Feel:**
    * **여백:** 충분한 Padding을 사용하여 콘텐츠 간의 숨 쉴 공간 확보.
    * **모서리:** 둥근 모서리 (Rounded Corners, `rounded-2xl` 이상) 적극 활용.
    * **색상:**
        * 배경: Off-white 또는 연한 회색 (눈의 피로 감소).
        * 포인트: 파스텔 톤의 태그 색상, 명확한 Primary Blue(액션), Critical Red(삭제).
    * **타이포그래피:** San Francisco (iOS System Font) 또는 Pretendard. 가독성을 최우선으로 함.
    * **피드백:** 터치 시 미세한 스케일 변화나 투명도 조절로 즉각적인 반응 제공.

## 3. 화면 상세 명세 (Detailed Views)

### 3.1. 내역 화면 (Transactions View) - 메인 화면
**[레이아웃 및 UI]**
* **헤더 (Header):**
    * **월 선택기:** 현재 'YYYY년 M월' 표시. 클릭 시 년/월 선택 피커(Picker) 노출.
    * **업로드 버튼:** 우측 상단 '+' 아이콘 또는 '업로드' 텍스트 버튼.
* **필터 (Filter Bar):**
    * 가로 스크롤 가능한 칩(Chip) 형태.
    * [전체] [카드사별] [카테고리별] [금액순] 등.
* **데이터 테이블 (Table List):**
    * 모바일 폭에 최적화된 리스트 형태 (가로 스크롤 없음).
    * **Row 구성 (좌측부터):**
        1.  **날짜:** `MM.DD` (고정 폭, 작고 흐린 텍스트)
        2.  **이용처:** (가변 폭, `flex-grow`). 공간 부족 시 텍스트 뒷부분 생략(`...`) 처리.
        3.  **카테고리:** (고정 폭). 뱃지(Badge) 형태. 아이콘 없이 텍스트만 깔끔하게.
        4.  **금액:** (고정 폭, 우측 정렬). 천 단위 콤마 포함.
* **행 추가 버튼 (FAB):**
    * 화면 우측 하단에 고정된 플로팅 버튼 (+).

**[인터랙션 및 기능]**
* **파일 업로드 (File Upload):**
    * `input type="file" multiple` 트리거.
    * **Process:** 파일 선택 -> '분석 중...' 로딩 인디케이터(Spinner) 오버레이 -> 완료 시 토스트(Toast) 메시지.
    * **중복 처리:** 백엔드 응답을 받아 "N건 업로드 완료 (중복 M건 제외됨)" 메시지 표시.
* **카테고리 수정:**
    * 테이블의 카테고리 뱃지 클릭(Tap) -> **바텀 시트(Bottom Sheet)** 오픈.
    * **구성:** 자주 쓰는 카테고리 태그 그리드 + '직접 입력' 버튼.
    * **직접 입력:** 클릭 시 인풋 창 활성화. 입력 후 엔터 시 해당 행에만 1회성 적용 (DB 태그 풀에 저장 안 함).
* **행 편집/삭제 (Row Actions):**
    * 행을 **길게 누르기 (Long Press)** -> 편집 모달(Modal) 팝업.
    * **편집 모달 구성:**
        * 우측 상단 'X' 버튼 (취소).
        * 입력 필드: 날짜, 이용처, 금액, 카테고리, 메모.
        * 하단 버튼 그룹:
            * **[삭제하기]:** 빨간색 텍스트. 클릭 시 "정말 삭제하시겠습니까?" Alert 띄움.
            * **[수정 완료]:** 변경 사항이 있을 때만 활성화(Blue).
* **행 추가:**
    * FAB 클릭 -> 빈 입력 필드가 있는 모달 팝업. '추가하기' 버튼으로 저장.
* **비슷한 거래 일괄 수정 (Similar Transactions Bulk Update):**
    * **트리거:** 카테고리 또는 이용처명 변경 시 자동으로 비슷한 거래 검색.
    * **패턴 매칭:** 이용처명에서 주요 키워드 추출 후 ILIKE 검색.
        * Stopwords 필터링: 회사명 접미사(주식회사, 유한회사), 결제 관련(페이, 카드), 도시명(서울, 부산 등).
    * **일괄 수정 모달 구성:**
        * 비슷한 거래 목록 (체크박스 + 거래 정보).
        * 전체 선택/해제 버튼.
        * 개별 항목 제거(X) 버튼.
        * 하단 버튼: [건너뛰기] [N건 일괄 수정].
    * **매핑 저장:** 수정 시 이용처-카테고리 매핑 저장 → 이후 업로드 시 자동 분류에 활용.
    * **UX 흐름:**
        1. 사용자가 거래의 카테고리/이용처명 변경 → 수정 완료.
        2. 시스템이 비슷한 거래 검색 (비동기).
        3. 비슷한 거래가 있으면 일괄 수정 모달 자동 표시.
        4. 없으면 모달 표시 없이 종료.

### 3.2. 분석 화면 (Dashboard View)
**[레이아웃 및 UI]**
* **네비게이션:** 상단 탭 또는 좌우 **스와이프(Swipe)** 제스처로 차트 간 이동 (Carousel UI).
* **페이지 인디케이터:** 하단에 현재 보고 있는 그래프 위치 표시 (● ○).

**[Card 1: 월별 지출 비중 (Pie Chart)]**
* **헤더:** 우측 상단 '캘린더' 아이콘으로 분석할 월 변경.
* **차트:** 도넛(Donut) 또는 파이 차트.
    * 상위 7개 카테고리는 고유 색상, 나머지는 회색조 '기타'로 통합.
    * 차트 중앙 또는 하단에 '총 지출액' 표시.
* **Drill-down:**
    * 차트의 섹션(조각) 클릭 -> 해당 카테고리의 내역만 필터링된 **내역 리스트 팝업** 호출.

**[Card 2: 월별 지출 추세 (Stacked Bar Chart)]**
* **기간 설정:** 차트 상단에 [3개월] [6개월] [12개월] 토글 버튼 (Segmented Control).
* **차트:**
    * X축: 월(Month), Y축: 금액.
    * 막대는 상위 5개 카테고리 색상으로 스택(Stacked), 나머지는 기타.
* **인사이트:** (옵션) 전월 대비 증감액("지난달보다 30만원 덜 썼어요")을 텍스트로 상단에 표시.

## 4. 기술 스택 및 라이브러리 (Tech Stack)
* **Framework:** Next.js (App Router), React
* **Styling:** Tailwind CSS
    * `shadcn/ui` (추천): 깔끔한 컴포넌트(Dialog, Sheet, Toast 등) 확보.
    * `lucide-react`: 아이콘 팩.
* **Charting:** `recharts` (React 친화적, 커스터마이징 용이).
* **State Management:** `TanStack Query` (서버 상태 동기화 및 캐싱 최적화).
* **Gesture:** `react-use-gesture` (스와이프 동작 구현 시).

## 5. 예외 처리 및 UX 디테일
* **로딩 상태:** 데이터 fetch 중일 때 스켈레톤(Skeleton) UI 노출.
* **데이터 없음:** 표시할 내역이 없을 때 "내역을 업로드해주세요"라는 친절한 안내 문구와 업로드 버튼 노출.
* **모바일 최적화:** 모든 버튼과 터치 타겟은 44px 이상으로 설정하여 터치 오류 방지.